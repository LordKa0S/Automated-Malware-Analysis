import yara
from os.path import normpath, join, isfile, dirname
from os import listdir, getcwd
RULE_DIR = r'rules'


def comp_gen():
    rulefiles = [file for file in listdir(
        RULE_DIR) if isfile(join(RULE_DIR, file)) and file.endswith('.yar')]
    address = {'namespace '+str(i): normpath(join(RULE_DIR,
                                                  rulefiles[i])) for i in range(0, len(rulefiles))}
    rules = yara.compile(filepaths=address)
    rules.save(normpath(join(dirname(__file__), 'my_compiled_rules')))


if __name__ == "__main__":
    comp_gen()
